# 実験データラベリングツール
最近、実験データを機械学習させろとか言われることが増えました。実験データを機械学習のツール（pandasとか）に読み込ませようとしたときに一番問題なのが、実験条件がデータのファイルにラベリングされていないということです。
これを解決するために作成したのが、EDTA(Expelimental Data Tag Authoring)です。

拙い点とバグはご容赦ください。データはバックアップを取ってから使ってください。
本プログラム作成では、AIエディタCursorに（初めのうちは）手伝ってもらいました。

## データファイルの前提条件

- 実験データは大かな条件ごと（フォルダ条件と言います）にフォルダーに入っている（このフォルダーの実験条件がフォルダー名からわからないのでラベル化が必要）。

- フォルダー内は"フォルダー条件"は同じで、個々の条件はファイル名に書かれている。


## 機能
#### 当たり前ですが、実験結果に影響を与えていると考えられる条件がラベルに含まれていなければ、最後に実験条件付きのデータまとめ*.csvが生成されても、そこから何の解析結果も得られないと思います。

ラベル付けするデータの一番上の階層を"root path"と呼ぶことにします。このroot直下は、ファイルに対しては2.のサブプロセスは実行されません。
（root pathの下は日付ごとにフォルダーが並んでいるイメージであり、直接データファイルを置かないとする）

1. データのラベリングですが、以下の条件でラベルの*.jsonを生成します。
フォルダーごとに"指定した名前.json"を生成します。これが"フォルダ条件"の保存先になります。
root pathにはマスターのjsonも生成します。これは"フォルダ条件"のkeyに対するvalueのリストを保存したものです。

  - フォルダーの中に子フォルダーがあるときは、*.jsonがなければ親フォルダーの条件がそのまま適用される。変更が必要なときは、同名の*.jsonをフォルダーに置けば親フォルダーの"フォルダー条件"が上書きされる。

2. それぞれのファイルから何を取り出すかは、サブプロセスのpythonファイルを指定して、各フォルダーごとに実行し、その結果を集めて、dataFrame型の1つの*.csvファイルを生成します。
サブプロセスの実行から除外したいときは、そのフォルダーに"指定した名前.no"というファイル名のファイルを置けばサブプロセスは実行されません（ただし、その子フォルダーには実行される）。

  -それぞれの実験データファイルから何を取り出すかは、subProcessの*.pyが実行する内容で変更できる（平均、均一性、パターン解析なら全点データを1行に並べ直す・・など）。

##ubProcessのpythonファイルの仕様につ

添付している"sub_print_csv.py"はただのサンプルですので、この部分はユーザーが作成します。
"sub_print_csv.py"は、2列データのうち、2列目のの3行目から31行目を取り出すだけのものです。

- 第１引数は、処理が必要なフォルダの絶対パス、第2引数はroot pathからの相対パスが入る。

- フォルダーで1度だけサブプロセスは呼ばれるので、データ処理したいファイルはサブプロセス内で探すこと。全csvファイルに実行する場合、glob.glob(fullpath+r"\*.csv")といった処理をサブプロセスの*.pyで実行する。

- （必要なら）ファイル名に含まれている実験条件を正規表現で取り出す。

- サブプロセスの出力は、標準出力(print)とする。列名のヘッダー行と、1ファイルあたり1行で出力する。

- ヘッダー行は複数行でも良い。実行時にサブプロセスのヘッダー長は指定できる（2ファイル目の結果から、単に削除するだけ）。

- データ長（列数）は可変でも良いが、可変にするとpandasのdataframeの読み込みで不都合があると思う。

## 使い方の手順（動作確認）

- 前提：Python3系がインストールされていること（3.13.1で動作確認）。

- 必要パッケージ PySide6

pip install PySide6 でインストールしてください.

- 必要ファイル（同じフォルダに配置）

 - EDTA_main.pyw
 
 - parameter_table.py

 - sub_print_csv.py（サンプルのサブプロセスを使う場合）

## 動作確認用データ

testdata フォルダにあります。

EDTA_main.pywをダブルクリックすると起動します。
